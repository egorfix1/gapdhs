#!/bin/bash
#SBATCH --nodes=1
#SBATCH --mem=50G
#SBATCH --time=424:00:00
#SBATCH --cpus-per-task=20
hsg="/gpfs/epetrukhin/genome/hg38"
hsextra="/gpfs/epetrukhin/genome/hg38_assembly_ss.ss"

for READS in SRR6916900_GSM3071647_LE.129.NG_M_Homo_sapiens_RNA-Seq SRR6916902_GSM3071649_LE.117.RB_M_Homo_sapiens_RNA-Seq SRR6916905_GSM3071652_BO.003.AW_M_Homo_sapiens_RNA-Seq SRR6916906_GSM3071653_BO.011.WK_M_Homo_sapiens_RNA-Seq SRR6916914_GSM3071661_KO.1031_M_Homo_sapiens_RNA-Seq SRR6916915_GSM3071662_KO.1248_M_Homo_sapiens_RNA-Seq SRR6916916_GSM3071663_KO.1347_M_Homo_sapiens_RNA-Seq SRR6916917_GSM3071664_LE.025.BI_M_Homo_sapiens_RNA-Seq SRR6916918_GSM3071665_KO.971_M_Homo_sapiens_RNA-Seq SRR6916919_GSM3071666_BO.005.SA_M_Homo_sapiens_RNA-Seq SRR6916921_GSM3071668_LE.049.SDI_M_Homo_sapiens_RNA-Seq SRR6916922_GSM3071669_LE.049.SDII_M_Homo_sapiens_RNA-Seq SRR6916923_GSM3071670_KO.1039_M_Homo_sapiens_RNA-Seq SRR6916924_GSM3071671_LE.049.SDIII_M_Homo_sapiens_RNA-Seq SRR6916938_GSM3071685_LE.105.TF_M_Homo_sapiens_RNA-Seq SRR6916939_GSM3071686_FKH.012_M_Homo_sapiens_RNA-Seq SRR6916943_GSM3071690_FKH.011_M_Homo_sapiens_RNA-Seq SRR6916944_GSM3071691_BO.001.SH_2_M_Homo_sapiens_RNA-Seq SRR6916945_GSM3071692_FKH.027_M_Homo_sapiens_RNA-Seq SRR6916946_GSM3071693_FKH.023_M_Homo_sapiens_RNA-Seq SRR6916947_GSM3071694_BO.019.WG_M_Homo_sapiens_RNA-Seq SRR6916948_GSM3071695_BO.015.BW_M_Homo_sapiens_RNA-Seq SRR6916949_GSM3071696_BO.017.BU_M_Homo_sapiens_RNA-Seq SRR6916952_GSM3071699_BO.013.NK_M_Homo_sapiens_RNA-Seq SRR6916954_GSM3071701_BO.025.SE_M_Homo_sapiens_RNA-Seq SRR6916955_GSM3071702_LE.081.TR_M_Homo_sapiens_RNA-Seq SRR6916956_GSM3071703_LE.041.RL_M_Homo_sapiens_RNA-Seq SRR6916957_GSM3071704_LE.057.HK_M_Homo_sapiens_RNA-Seq SRR6916958_GSM3071705_KO.1221_M_Homo_sapiens_RNA-Seq SRR6916959_GSM3071706_LE.051.WD_M_Homo_sapiens_RNA-Seq SRR6916961_GSM3071708_FKH.007_M_Homo_sapiens_RNA-Seq SRR6916962_GSM3071709_LE.085.BU_M_Homo_sapiens_RNA-Seq SRR6916965_GSM3071712_LE.073.HK_M_Homo_sapiens_RNA-Seq SRR6916938_GSM3071685_LE.105.TF_M_Homo_sapiens_RNA-Seq SRR6916959_GSM3071706_LE.051.WD_M_Homo_sapiens_RNA-Seq SRR6916958_GSM3071705_KO.1221_M_Homo_sapiens_RNA-Seq SRR6916957_GSM3071704_LE.057.HK_M_Homo_sapiens_RNA-Seq SRR6916924_GSM3071671_LE.049.SDIII_M_Homo_sapiens_RNA-Seq SRR6916956_GSM3071703_LE.041.RL_M_Homo_sapiens_RNA-Seq SRR6916955_GSM3071702_LE.081.TR_M_Homo_sapiens_RNA-Seq SRR6916922_GSM3071669_LE.049.SDII_M_Homo_sapiens_RNA-Seq SRR6916917_GSM3071664_LE.025.BI_M_Homo_sapiens_RNA-Seq SRR6916921_GSM3071668_LE.049.SDI_M_Homo_sapiens_RNA-Seq SRR6916914_GSM3071661_KO.1031_M_Homo_sapiens_RNA-Seq SRR6916900_GSM3071647_LE.129.NG_M_Homo_sapiens_RNA-Seq SRR6916918_GSM3071665_KO.971_M_Homo_sapiens_RNA-Seq SRR6916902_GSM3071649_LE.117.RB_M_Homo_sapiens_RNA-Seq SRR6916954_GSM3071701_BO.025.SE_M_Homo_sapiens_RNA-Seq SRR6916937_GSM3071684_FKH.021_M_Homo_sapiens_RNA-Seq SRR6916903_GSM3071650_LE.037.RG_M_Homo_sapiens_RNA-Seq SRR6916904_GSM3071651_KO.679_M_Homo_sapiens_RNA-Seq SRR6916920_GSM3071667_MA.001.SH_M_Homo_sapiens_RNA-Seq SRR6916907_GSM3071654_LE.039.BE_M_Homo_sapiens_RNA-Seq
do
        hisat2 \
                -x $hsg/hg38_assembly_canon\
                --known-splicesite-infile hsextra \
                --threads 20 \
                --novel-splicesite-outfile $READS_new_ss.txt \
                -1 $READS'_1.fastq.gz' \
                -2 $READS'_2.fastq.gz' \
                --dta-cufflinks \
                2> $READS.hs.R.txt | \
        samtools sort -o ./mapped_reads/$READS.bam -
done


